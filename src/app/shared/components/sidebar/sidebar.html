<aside
    class="fixed top-0 right-0 h-full bg-surface-50 dark:bg-surface-900 transition-transform duration-300 ease-in-out z-40 w-full sm:w-96 lg:w-80 lg:border-none md:border-l border-surface-300 dark:border-surface-700"
    [ngClass]="{
        'translate-x-0': visible,
        'translate-x-full': !visible,
        'lg:translate-x-0': !isMobile
    }">

    <!-- Sidebar Header -->
    <div class="flex items-center justify-between p-4">
        <h2 class="text-xl font-semibold text-surface-900 dark:text-surface-0">Menú</h2>
        <!-- Close button for mobile -->
        <button class="lg:hidden p-2 rounded-lg hover:bg-surface-100 dark:hover:bg-surface-800 transition-colors"
            (click)="closeSidebar()" aria-label="Cerrar menú">
            <i class="pi pi-times text-surface-600 dark:text-surface-400"></i>
        </button>
    </div>

    <!-- Menu Items -->
    <nav class="flex-1 overflow-y-auto p-4">
        <ul class="p-2 space-y-1">
            <li *ngFor="let item of menuItems; trackBy: trackByMenuItem">
                <a [routerLink]="item.routerLink" [routerLinkActive]="'!text-primary-500'"
                    [routerLinkActiveOptions]="{ exact: true }"
                    class="flex items-center gap-3 p-3 rounded-lg text-surface-700 dark:text-surface-300 hover:bg-surface-100 dark:hover:bg-surface-800 transition-colors cursor-pointer"
                    (click)="onMenuItemClick(item)">
                    <i *ngIf="item.icon" [class]="item.icon + ''"></i>
                    <span class="font-medium">{{ item.label }}</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Calendar Section -->
    <div class="p-4 pt-8 mt-4 border-t border-surface-200 dark:border-surface-700">
        <div class="bg-surface-100 dark:bg-surface-800 rounded-lg p-4">
            <h3 class="text-sm font-semibold text-surface-700 dark:text-surface-300 mb-3 text-center">
                {{ currentDate | date:'MMMM yyyy' }}
            </h3>
            <div class="grid grid-cols-7 gap-1 text-xs">
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">L</div>
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">M</div>
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">X</div>
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">J</div>
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">V</div>
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">S</div>
                <div class="text-center text-surface-500 dark:text-surface-400 font-medium">D</div>

                <div *ngFor="let day of calendarDays" class="text-center p-1 rounded-full" [class]="day.isCurrentDay ?
                              'bg-primary-500 text-surface-0 font-medium' :
                              'text-surface-600 dark:text-surface-400'">
                    {{ day.day }}
                </div>
            </div>
        </div>
    </div>
</aside>

<!-- Mobile Overlay -->
<div *ngIf="visible && isMobile" class="fixed inset-0 bg-black/80 bg-opacity-50 z-30 lg:hidden"
    (click)="closeSidebar()">
</div>